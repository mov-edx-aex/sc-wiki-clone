<!DOCTYPE html>
<html class="client-nojs" lang="en-GB" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Module:Documentation - The Explorer's Compendium</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"ZbPFDVVKx8gdSGW8okL7_gAAABE","wgCSPNonce":false,"wgCanonicalNamespace":"Module","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":828,"wgPageName":"Module:Documentation","wgTitle":"Documentation","wgCurRevisionId":1929,"wgRevisionId":1929,"wgArticleId":221,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":"Awesome Pilot","wgUserGroups":["*","user","autoconfirmed"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"Scribunto","wgRelevantPageName":"Module:Documentation","wgRelevantArticleId":221,"wgUserId":1430,"wgUserIsTemp":false,"wgUserEditCount":5,"wgUserRegistration":1705555887000,"wgIsProbablyEditable":true,
"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[]};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","skins.timeless":"ready"};RLPAGEMODULES=["ext.preToClip","site","mediawiki.page.ready","skins.timeless.js","mediawiki.page.watch.ajax"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"d33fdf82ba09435cbebcdfeddb0220bc65b3c50d+\\","watchToken":"f98d0f34c64c843a42f4e7a89e12302765b3c50d+\\","csrfToken":"5a8bb06283777e700ab85fb18f7ab39065b3c50d+\\"});});});</script>
<link rel="stylesheet" href="load.php@lang=en-gb&amp;modules=skins.timeless&amp;only=styles&amp;skin=timeless.css"/>
<script async="" src="load.php@lang=en-gb&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=timeless"></script>
<!--[if IE]><link rel="stylesheet" href="/skins/Timeless/resources/IE9fixes.css?ffe73" media="screen"/><![endif]-->
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php@lang=en-gb&amp;modules=site.styles&amp;only=styles&amp;skin=timeless.css"/>
<meta name="generator" content="MediaWiki 1.40.1"/>
<meta name="robots" content="max-image-preview:standard"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0"/>
<link rel="alternate" type="application/x-wiki" title="Edit" href="index.php@title=Module%253ADocumentation&amp;action=edit.html"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="The Explorer&#039;s Compendium (en-gb)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php@action=rsd"/>
<link rel="license" href="Public%253ACopyright.html"/>
<link rel="alternate" type="application/atom+xml" title="The Explorer&#039;s Compendium Atom feed" href="index.php@title=Special%253ARecentChanges&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-828 ns-subject mw-editable page-Module_Documentation rootpage-Module_Documentation skin-timeless action-view skin--responsive"><div id="mw-wrapper"><div id="mw-header-container" class="ts-container"><div id="mw-header" class="ts-inner"><div id="user-tools"><div id="personal"><h2><span>Awesome Pilot</span></h2><div id="personal-inner" class="dropdown"><div role="navigation" class="mw-portlet" id="p-personal" title="User menu" aria-labelledby="p-personal-label"><h3 id="p-personal-label" lang="en-GB" dir="ltr">Logged in as <b>Awesome Pilot</b></h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="pt-userpage" class="mw-list-item"><a href="User%253AEsi_Otomeya.html" title="Your user page [.]" accesskey="."><span>User page</span></a></li><li id="pt-mytalk" class="mw-list-item"><a href="User_talk%253AEsi_Otomeya.html" class="new" title="Your talk page (page does not exist) [n]" accesskey="n"><span>User talk</span></a></li><li id="pt-preferences" class="mw-list-item"><a href="Special%253APreferences.html" title="Your preferences"><span>Preferences</span></a></li><li id="pt-watchlist" class="mw-list-item"><a href="Special%253AWatchlist.html" title="A list of pages you are monitoring for changes [l]" accesskey="l"><span>Watchlist</span></a></li><li id="pt-mycontris" class="mw-list-item"><a href="Special%253AContributions/Esi_Otomeya.html" title="A list of your contributions [y]" accesskey="y"><span>Contributions</span></a></li><li id="pt-logout" class="mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Special:UserLogout&amp;returnto=Module%3ADocumentation" data-mw="interface" title="Log out"><span>Log out</span></a></li></ul></div></div></div></div></div><div id="p-logo-text" class="mw-portlet" role="banner"><a id="p-banner" class="mw-wiki-title long" href="index.php.html">The Explorer&#039;s Compendium</a></div><div class="mw-portlet" id="p-search"><h3 lang="en-GB" dir="ltr"><label for="searchInput">Search</label></h3><form action="index.php.html" id="searchform"><div id="simpleSearch"><div id="searchInput-container"><input type="search" name="search" placeholder="Search The Explorer&#039;s Compendium" aria-label="Search The Explorer&#039;s Compendium" autocapitalize="sentences" title="Search The Explorer&#039;s Compendium [f]" accesskey="f" id="searchInput"/></div><input type="hidden" value="Special:Search" name="title"/><input class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search pages for this text" id="mw-searchButton" value="Search"/><input class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" id="searchButton" value="Go"/></div></form></div></div><div class="visualClear"></div></div><div id="mw-header-hack" class="color-bar"><div class="color-middle-container"><div class="color-middle"></div></div><div class="color-left"></div><div class="color-right"></div></div><div id="mw-header-nav-hack"><div class="color-bar"><div class="color-middle-container"><div class="color-middle"></div></div><div class="color-left"></div><div class="color-right"></div></div></div><div id="menus-cover"></div><div id="mw-content-container" class="ts-container"><div id="mw-content-block" class="ts-inner"><div id="mw-content-wrapper"><div id="mw-content"><div id="content" class="mw-body" role="main"><div class="mw-indicators">
</div>
<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-namespace">Module</span><span class="mw-page-title-separator">:</span><span class="mw-page-title-main">Documentation</span></h1><div id="bodyContentOuter"><div id="siteSub"></div><div id="mw-page-header-links"><div role="navigation" class="mw-portlet tools-inline" id="p-namespaces" aria-labelledby="p-namespaces-label"><h3 id="p-namespaces-label" lang="en-GB" dir="ltr">Namespaces</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="ca-nstab-module" class="selected mw-list-item"><a href="Module%253ADocumentation.html" title="View the module page"><span>Module</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Module_talk:Documentation&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li><li id="ca-watch" class="mw-watchlink mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Module:Documentation&amp;action=watch" data-mw="interface" title="Add this page to your watchlist [w]" accesskey="w"><span>Watch</span></a></li></ul></div></div><div role="navigation" class="mw-portlet tools-inline" id="p-more" aria-labelledby="p-more-label"><h3 id="p-more-label" lang="en-GB" dir="ltr">More</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="ca-more" class="dropdown-toggle mw-list-item"><span>More</span></li></ul></div></div><div role="navigation" class="mw-portlet tools-inline" id="p-views" aria-labelledby="p-views-label"><h3 id="p-views-label" lang="en-GB" dir="ltr">Page actions</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="ca-view" class="selected mw-list-item"><a href="Module%253ADocumentation.html"><span>Read</span></a></li><li id="ca-edit" class="mw-list-item"><a href="index.php@title=Module%253ADocumentation&amp;action=edit.html" title="Edit this page [e]" accesskey="e"><span>Edit</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Module:Documentation&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>History</span></a></li></ul></div></div></div><div class="visualClear"></div><div id="bodyContent"><div id="contentSub"><div id="mw-content-subtitle"></div></div><div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div lang="en-GB" dir="ltr" class="mw-content-ltr">
<p><i>Documentation for this module may be created at <a href="index.php@title=Module%253ADocumentation%252Fdoc&amp;action=edit&amp;redlink=1.html" class="new" title="Module:Documentation/doc (page does not exist)">Module:Documentation/doc</a></i>
</p>
</div><pre class='mw-code mw-script' dir='ltr'>
-- This module implements {{documentation}}.

-- Get required modules.
local getArgs = require(&#039;Module:Arguments&#039;).getArgs

-- Get the config table.
local cfg = mw.loadData(&#039;Module:Documentation/config&#039;)

local p = {}

-- Often-used functions.
local ugsub = mw.ustring.gsub

----------------------------------------------------------------------------
-- Helper functions
--
-- These are defined as local functions, but are made available in the p
-- table for testing purposes.
----------------------------------------------------------------------------

local function message(cfgKey, valArray, expectType)
	--[[
	-- Gets a message from the cfg table and formats it if appropriate.
	-- The function raises an error if the value from the cfg table is not
	-- of the type expectType. The default type for expectType is &#039;string&#039;.
	-- If the table valArray is present, strings such as $1, $2 etc. in the
	-- message are substituted with values from the table keys [1], [2] etc.
	-- For example, if the message &quot;foo-message&quot; had the value &#039;Foo $2 bar $1.&#039;,
	-- message(&#039;foo-message&#039;, {&#039;baz&#039;, &#039;qux&#039;}) would return &quot;Foo qux bar baz.&quot;
	--]]
	local msg = cfg[cfgKey]
	expectType = expectType or &#039;string&#039;
	if type(msg) ~= expectType then
		error(&#039;message: type error in message cfg.&#039; .. cfgKey .. &#039; (&#039; .. expectType .. &#039; expected, got &#039; .. type(msg) .. &#039;)&#039;, 2)
	end
	if not valArray then
		return msg
	end

	local function getMessageVal(match)
		match = tonumber(match)
		return valArray[match] or error(&#039;message: no value found for key $&#039; .. match .. &#039; in message cfg.&#039; .. cfgKey, 4)
	end

	return ugsub(msg, &#039;$([1-9][0-9]*)&#039;, getMessageVal)
end

p.message = message

local function makeWikilink(page, display)
	if display then
		return mw.ustring.format(&#039;[[%s|%s]]&#039;, page, display)
	else
		return mw.ustring.format(&#039;[[%s]]&#039;, page)
	end
end

p.makeWikilink = makeWikilink

local function makeCategoryLink(cat, sort)
	local catns = mw.site.namespaces[14].name
	return makeWikilink(catns .. &#039;:&#039; .. cat, sort)
end

p.makeCategoryLink = makeCategoryLink

local function makeUrlLink(url, display)
	return mw.ustring.format(&#039;[%s %s]&#039;, url, display)
end

p.makeUrlLink = makeUrlLink

local function makeToolbar(...)
	local ret = {}
	local lim = select(&#039;#&#039;, ...)
	if lim &lt; 1 then
		return nil
	end
	for i = 1, lim do
		ret[#ret + 1] = select(i, ...)
	end
	-- &#039;documentation-toolbar&#039;
	return &#039;&lt;span class=&quot;&#039; .. message(&#039;toolbar-class&#039;) .. &#039;&quot;&gt;(&#039;
		.. table.concat(ret, &#039; &amp;#124; &#039;) .. &#039;)&lt;/span&gt;&#039;
end	

p.makeToolbar = makeToolbar

----------------------------------------------------------------------------
-- Argument processing
----------------------------------------------------------------------------

local function makeInvokeFunc(funcName)
	return function (frame)
		local args = getArgs(frame, {
			valueFunc = function (key, value)
				if type(value) == &#039;string&#039; then
					value = value:match(&#039;^%s*(.-)%s*$&#039;) -- Remove whitespace.
					if key == &#039;heading&#039; or value ~= &#039;&#039; then
						return value
					else
						return nil
					end
				else
					return value
				end
			end
		})
		return p[funcName](args)
	end
end

----------------------------------------------------------------------------
-- Entry points
----------------------------------------------------------------------------

function p.nonexistent(frame)
	if mw.title.getCurrentTitle().subpageText == &#039;testcases&#039; then
		return frame:expandTemplate{title = &#039;module test cases notice&#039;}
	else
		return p.main(frame)
	end
end

p.main = makeInvokeFunc(&#039;_main&#039;)

function p._main(args)
	--[[
	-- This function defines logic flow for the module.
	-- @args - table of arguments passed by the user
	--]]
	local env = p.getEnvironment(args)
	local root = mw.html.create()
	root
		:wikitext(p._getModuleWikitext(args, env))
		:wikitext(p.protectionTemplate(env))
		:wikitext(p.sandboxNotice(args, env))
		:tag(&#039;div&#039;)
			-- &#039;documentation-container&#039;
			:addClass(message(&#039;container&#039;))
			:newline()
			:tag(&#039;div&#039;)
				-- &#039;documentation&#039;
				:addClass(message(&#039;main-div-classes&#039;))
				:newline()
				:wikitext(p._startBox(args, env))
				:wikitext(p._content(args, env))
				:tag(&#039;div&#039;)
					-- &#039;documentation-clear&#039;
					:addClass(message(&#039;clear&#039;))
					:done()
				:newline()
				:done()
			:wikitext(p._endBox(args, env))
			:done()
		:wikitext(p.addTrackingCategories(env))
	-- &#039;Module:Documentation/styles.css&#039;
	-- return mw.getCurrentFrame():extensionTag (
	--	&#039;templatestyles&#039;, &#039;&#039;, {src=cfg[&#039;templatestyles&#039;]
	--}) .. 
        return tostring(root)
end

----------------------------------------------------------------------------
-- Environment settings
----------------------------------------------------------------------------

function p.getEnvironment(args)
	--[[
	-- Returns a table with information about the environment, including title
	-- objects and other namespace- or path-related data.
	-- @args - table of arguments passed by the user
	--
	-- Title objects include:
	-- env.title - the page we are making documentation for (usually the current title)
	-- env.templateTitle - the template (or module, file, etc.)
	-- env.docTitle - the /doc subpage.
	-- env.sandboxTitle - the /sandbox subpage.
	-- env.testcasesTitle - the /testcases subpage.
	-- env.printTitle - the print version of the template, located at the /Print subpage.
	--
	-- Data includes:
	-- env.protectionLevels - the protection levels table of the title object.
	-- env.subjectSpace - the number of the title&#039;s subject namespace.
	-- env.docSpace - the number of the namespace the title puts its documentation in.
	-- env.docpageBase - the text of the base page of the /doc, /sandbox and /testcases pages, with namespace.
	-- env.compareUrl - URL of the Special:ComparePages page comparing the sandbox with the template.
	-- 
	-- All table lookups are passed through pcall so that errors are caught. If an error occurs, the value
	-- returned will be nil.
	--]]
	
	local env, envFuncs = {}, {}

	-- Set up the metatable. If triggered we call the corresponding function in the envFuncs table. The value
	-- returned by that function is memoized in the env table so that we don&#039;t call any of the functions
	-- more than once. (Nils won&#039;t be memoized.)
	setmetatable(env, {
		__index = function (t, key)
			local envFunc = envFuncs[key]
			if envFunc then
				local success, val = pcall(envFunc)
				if success then
					env[key] = val -- Memoise the value.
					return val
				end
			end
			return nil
		end
	})	

	function envFuncs.title()
		-- The title object for the current page, or a test page passed with args.page.
		local title
		local titleArg = args.page
		if titleArg then
			title = mw.title.new(titleArg)
		else
			title = mw.title.getCurrentTitle()
		end
		return title
	end

	function envFuncs.templateTitle()
		--[[
		-- The template (or module, etc.) title object.
		-- Messages:
		-- &#039;sandbox-subpage&#039; --&gt; &#039;sandbox&#039;
		-- &#039;testcases-subpage&#039; --&gt; &#039;testcases&#039;
		--]]
		local subjectSpace = env.subjectSpace
		local title = env.title
		local subpage = title.subpageText
		if subpage == message(&#039;sandbox-subpage&#039;) or subpage == message(&#039;testcases-subpage&#039;) then
			return mw.title.makeTitle(subjectSpace, title.baseText)
		else
			return mw.title.makeTitle(subjectSpace, title.text)
		end
	end

	function envFuncs.docTitle()
		--[[
		-- Title object of the /doc subpage.
		-- Messages:
		-- &#039;doc-subpage&#039; --&gt; &#039;doc&#039;
		--]]
		local title = env.title
		local docname = args[1] -- User-specified doc page.
		local docpage
		if docname then
			docpage = docname
		else
			docpage = env.docpageBase .. &#039;/&#039; .. message(&#039;doc-subpage&#039;)
		end
		return mw.title.new(docpage)
	end
	
	function envFuncs.sandboxTitle()
		--[[
		-- Title object for the /sandbox subpage.
		-- Messages:
		-- &#039;sandbox-subpage&#039; --&gt; &#039;sandbox&#039;
		--]]
		return mw.title.new(env.docpageBase .. &#039;/&#039; .. message(&#039;sandbox-subpage&#039;))
	end
	
	function envFuncs.testcasesTitle()
		--[[
		-- Title object for the /testcases subpage.
		-- Messages:
		-- &#039;testcases-subpage&#039; --&gt; &#039;testcases&#039;
		--]]
		return mw.title.new(env.docpageBase .. &#039;/&#039; .. message(&#039;testcases-subpage&#039;))
	end
	
	function envFuncs.printTitle()
		--[[
		-- Title object for the /Print subpage.
		-- Messages:
		-- &#039;print-subpage&#039; --&gt; &#039;Print&#039;
		--]]
		return env.templateTitle:subPageTitle(message(&#039;print-subpage&#039;))
	end

	function envFuncs.protectionLevels()
		-- The protection levels table of the title object.
		return env.title.protectionLevels
	end

	function envFuncs.subjectSpace()
		-- The subject namespace number.
		return mw.site.namespaces[env.title.namespace].subject.id
	end

	function envFuncs.docSpace()
		-- The documentation namespace number. For most namespaces this is the
		-- same as the subject namespace. However, pages in the Article, File,
		-- MediaWiki or Category namespaces must have their /doc, /sandbox and
		-- /testcases pages in talk space.
		local subjectSpace = env.subjectSpace
		if subjectSpace == 0 or subjectSpace == 6 or subjectSpace == 8 or subjectSpace == 14 then
			return subjectSpace + 1
		else
			return subjectSpace
		end
	end

	function envFuncs.docpageBase()
		-- The base page of the /doc, /sandbox, and /testcases subpages.
		-- For some namespaces this is the talk page, rather than the template page.
		local templateTitle = env.templateTitle
		local docSpace = env.docSpace
		local docSpaceText = mw.site.namespaces[docSpace].name
		-- Assemble the link. docSpace is never the main namespace, so we can hardcode the colon.
		return docSpaceText .. &#039;:&#039; .. templateTitle.text
	end
	
	function envFuncs.compareUrl()
		-- Diff link between the sandbox and the main template using [[Special:ComparePages]].
		local templateTitle = env.templateTitle
		local sandboxTitle = env.sandboxTitle
		if templateTitle.exists and sandboxTitle.exists then
			local compareUrl = mw.uri.fullUrl(
				&#039;Special:ComparePages&#039;,
				{ page1 = templateTitle.prefixedText, page2 = sandboxTitle.prefixedText}
			)
			return tostring(compareUrl)
		else
			return nil
		end
	end		

	return env
end	

----------------------------------------------------------------------------
-- Auxiliary templates
----------------------------------------------------------------------------

p.getModuleWikitext = makeInvokeFunc(&#039;_getModuleWikitext&#039;)

function p._getModuleWikitext(args, env)
	local currentTitle = mw.title.getCurrentTitle()
	if currentTitle.contentModel ~= &#039;Scribunto&#039; then return end
	pcall(require, currentTitle.prefixedText) -- if it fails, we don&#039;t care
	local moduleWikitext =  package.loaded[&quot;Module:Module wikitext&quot;]
	if moduleWikitext then
		return moduleWikitext.main()
	end
end

function p.sandboxNotice(args, env)
	--[=[
	-- Generates a sandbox notice for display above sandbox pages.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- 
	-- Messages:
	-- &#039;sandbox-notice-image&#039; --&gt; &#039;[[Image:Sandbox.svg|50px|alt=|link=]]&#039;
	-- &#039;sandbox-notice-blurb&#039; --&gt; &#039;This is the $1 for $2.&#039;
	-- &#039;sandbox-notice-diff-blurb&#039; --&gt; &#039;This is the $1 for $2 ($3).&#039;
	-- &#039;sandbox-notice-pagetype-template&#039; --&gt; &#039;[[Wikipedia:Template test cases|template sandbox]] page&#039;
	-- &#039;sandbox-notice-pagetype-module&#039; --&gt; &#039;[[Wikipedia:Template test cases|module sandbox]] page&#039;
	-- &#039;sandbox-notice-pagetype-other&#039; --&gt; &#039;sandbox page&#039;
	-- &#039;sandbox-notice-compare-link-display&#039; --&gt; &#039;diff&#039;
	-- &#039;sandbox-notice-testcases-blurb&#039; --&gt; &#039;See also the companion subpage for $1.&#039;
	-- &#039;sandbox-notice-testcases-link-display&#039; --&gt; &#039;test cases&#039;
	-- &#039;sandbox-category&#039; --&gt; &#039;Template sandboxes&#039;
	--]=]
	local title = env.title
	local sandboxTitle = env.sandboxTitle
	local templateTitle = env.templateTitle
	local subjectSpace = env.subjectSpace
	if not (subjectSpace and title and sandboxTitle and templateTitle
		and mw.title.equals(title, sandboxTitle)) then
		return nil
	end
	-- Build the table of arguments to pass to {{ombox}}. We need just two fields, &quot;image&quot; and &quot;text&quot;.
	local omargs = {}
	omargs.image = message(&#039;sandbox-notice-image&#039;)
	-- Get the text. We start with the opening blurb, which is something like
	-- &quot;This is the template sandbox for [[Template:Foo]] (diff).&quot;
	local text = &#039;&#039;
	local pagetype
	if subjectSpace == 10 then
		pagetype = message(&#039;sandbox-notice-pagetype-template&#039;)
	elseif subjectSpace == 828 then
		pagetype = message(&#039;sandbox-notice-pagetype-module&#039;)
	else
		pagetype = message(&#039;sandbox-notice-pagetype-other&#039;)
	end
	local templateLink = makeWikilink(templateTitle.prefixedText)
	local compareUrl = env.compareUrl
	if compareUrl then
		local compareDisplay = message(&#039;sandbox-notice-compare-link-display&#039;)
		local compareLink = makeUrlLink(compareUrl, compareDisplay)
		text = text .. message(&#039;sandbox-notice-diff-blurb&#039;, {pagetype, templateLink, compareLink})
	else
		text = text .. message(&#039;sandbox-notice-blurb&#039;, {pagetype, templateLink})
	end
	-- Get the test cases page blurb if the page exists. This is something like
	-- &quot;See also the companion subpage for [[Template:Foo/testcases|test cases]].&quot;
	local testcasesTitle = env.testcasesTitle
	if testcasesTitle and testcasesTitle.exists then
		if testcasesTitle.contentModel == &quot;Scribunto&quot; then
			local testcasesLinkDisplay = message(&#039;sandbox-notice-testcases-link-display&#039;)
			local testcasesRunLinkDisplay = message(&#039;sandbox-notice-testcases-run-link-display&#039;)
			local testcasesLink = makeWikilink(testcasesTitle.prefixedText, testcasesLinkDisplay)
			local testcasesRunLink = makeWikilink(testcasesTitle.talkPageTitle.prefixedText, testcasesRunLinkDisplay)
			text = text .. &#039;&lt;br /&gt;&#039; .. message(&#039;sandbox-notice-testcases-run-blurb&#039;, {testcasesLink, testcasesRunLink})
		else
			local testcasesLinkDisplay = message(&#039;sandbox-notice-testcases-link-display&#039;)
			local testcasesLink = makeWikilink(testcasesTitle.prefixedText, testcasesLinkDisplay)
			text = text .. &#039;&lt;br /&gt;&#039; .. message(&#039;sandbox-notice-testcases-blurb&#039;, {testcasesLink})
		end
	end
	-- Add the sandbox to the sandbox category.
	omargs.text = text .. makeCategoryLink(message(&#039;sandbox-category&#039;))

	-- &#039;documentation-clear&#039;
	return &#039;&lt;div class=&quot;&#039; .. message(&#039;clear&#039;) .. &#039;&quot;&gt;&lt;/div&gt;&#039;
		.. require(&#039;Module:Message box&#039;).main(&#039;ombox&#039;, omargs)
end

function p.protectionTemplate(env)
	-- Generates the padlock icon in the top right.
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- Messages:
	-- &#039;protection-template&#039; --&gt; &#039;pp-template&#039;
	-- &#039;protection-template-args&#039; --&gt; {docusage = &#039;yes&#039;}
	local protectionLevels = env.protectionLevels
	if not protectionLevels then
		return nil
	end
	local editProt = protectionLevels.edit and protectionLevels.edit[1]
	local moveProt = protectionLevels.move and protectionLevels.move[1]
	if editProt then
		-- The page is edit-protected.
		return require(&#039;Module:Protection banner&#039;)._main{
			message(&#039;protection-reason-edit&#039;), small = true
		}
	elseif moveProt and moveProt ~= &#039;autoconfirmed&#039; then
		-- The page is move-protected but not edit-protected. Exclude move
		-- protection with the level &quot;autoconfirmed&quot;, as this is equivalent to
		-- no move protection at all.
		return require(&#039;Module:Protection banner&#039;)._main{
			action = &#039;move&#039;, small = true
		}
	else
		return nil
	end
end

----------------------------------------------------------------------------
-- Start box
----------------------------------------------------------------------------

p.startBox = makeInvokeFunc(&#039;_startBox&#039;)

function p._startBox(args, env)
	--[[
	-- This function generates the start box.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- 
	-- The actual work is done by p.makeStartBoxLinksData and p.renderStartBoxLinks which make
	-- the [view] [edit] [history] [purge] links, and by p.makeStartBoxData and p.renderStartBox
	-- which generate the box HTML.
	--]]
	env = env or p.getEnvironment(args)
	local links
	local content = args.content
	if not content or args[1] then
		-- No need to include the links if the documentation is on the template page itself.
		local linksData = p.makeStartBoxLinksData(args, env)
		if linksData then
			links = p.renderStartBoxLinks(linksData)
		end
	end
	-- Generate the start box html.
	local data = p.makeStartBoxData(args, env, links)
	if data then
		return p.renderStartBox(data)
	else
		-- User specified no heading.
		return nil
	end
end

function p.makeStartBoxLinksData(args, env)
	--[[
	-- Does initial processing of data to make the [view] [edit] [history] [purge] links.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- 
	-- Messages:
	-- &#039;view-link-display&#039; --&gt; &#039;view&#039;
	-- &#039;edit-link-display&#039; --&gt; &#039;edit&#039;
	-- &#039;history-link-display&#039; --&gt; &#039;history&#039;
	-- &#039;purge-link-display&#039; --&gt; &#039;purge&#039;
	-- &#039;file-docpage-preload&#039; --&gt; &#039;Template:Documentation/preload-filespace&#039;
	-- &#039;module-preload&#039; --&gt; &#039;Template:Documentation/preload-module-doc&#039;
	-- &#039;docpage-preload&#039; --&gt; &#039;Template:Documentation/preload&#039;
	-- &#039;create-link-display&#039; --&gt; &#039;create&#039;
	--]]
	local subjectSpace = env.subjectSpace
	local title = env.title
	local docTitle = env.docTitle
	if not title or not docTitle then
		return nil
	end
	if docTitle.isRedirect then 
		docTitle = docTitle.redirectTarget
	end

	local data = {}
	data.title = title
	data.docTitle = docTitle
	-- View, display, edit, and purge links if /doc exists.
	data.viewLinkDisplay = message(&#039;view-link-display&#039;)
	data.editLinkDisplay = message(&#039;edit-link-display&#039;)
	data.historyLinkDisplay = message(&#039;history-link-display&#039;)
	data.purgeLinkDisplay = message(&#039;purge-link-display&#039;)
	-- Create link if /doc doesn&#039;t exist.
	local preload = args.preload
	if not preload then
		if subjectSpace == 6 then -- File namespace
			preload = message(&#039;file-docpage-preload&#039;)
		elseif subjectSpace == 828 then -- Module namespace
			preload = message(&#039;module-preload&#039;)
		else
			preload = message(&#039;docpage-preload&#039;)
		end
	end
	data.preload = preload
	data.createLinkDisplay = message(&#039;create-link-display&#039;)
	return data
end

function p.renderStartBoxLinks(data)
	--[[
	-- Generates the [view][edit][history][purge] or [create] links from the data table.
	-- @data - a table of data generated by p.makeStartBoxLinksData
	--]]
	
	local function escapeBrackets(s)
		-- Escapes square brackets with HTML entities.
		s = s:gsub(&#039;%[&#039;, &#039;&amp;#91;&#039;) -- Replace square brackets with HTML entities.
		s = s:gsub(&#039;%]&#039;, &#039;&amp;#93;&#039;)
		return s
	end

	local ret
	local docTitle = data.docTitle
	local title = data.title
	if docTitle.exists then
		local viewLink = makeWikilink(docTitle.prefixedText, data.viewLinkDisplay)
		local editLink = makeUrlLink(docTitle:fullUrl{action = &#039;edit&#039;}, data.editLinkDisplay)
		local historyLink = makeUrlLink(docTitle:fullUrl{action = &#039;history&#039;}, data.historyLinkDisplay)
		local purgeLink = makeUrlLink(title:fullUrl{action = &#039;purge&#039;}, data.purgeLinkDisplay)
		ret = &#039;[%s] [%s] [%s] [%s]&#039;
		ret = escapeBrackets(ret)
		ret = mw.ustring.format(ret, viewLink, editLink, historyLink, purgeLink)
	else
		local createLink = makeUrlLink(docTitle:fullUrl{action = &#039;edit&#039;, preload = data.preload}, data.createLinkDisplay)
		ret = &#039;[%s]&#039;
		ret = escapeBrackets(ret)
		ret = mw.ustring.format(ret, createLink)
	end
	return ret
end

function p.makeStartBoxData(args, env, links)
	--[=[
	-- Does initial processing of data to pass to the start-box render function, p.renderStartBox.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- @links - a string containing the [view][edit][history][purge] links - could be nil if there&#039;s an error.
	--
	-- Messages:
	-- &#039;documentation-icon-wikitext&#039; --&gt; &#039;[[File:Test Template Info-Icon - Version (2).svg|50px|link=|alt=]]&#039;
	-- &#039;template-namespace-heading&#039; --&gt; &#039;Template documentation&#039;
	-- &#039;module-namespace-heading&#039; --&gt; &#039;Module documentation&#039;
	-- &#039;file-namespace-heading&#039; --&gt; &#039;Summary&#039;
	-- &#039;other-namespaces-heading&#039; --&gt; &#039;Documentation&#039;
	-- &#039;testcases-create-link-display&#039; --&gt; &#039;create&#039;
	--]=]
	local subjectSpace = env.subjectSpace
	if not subjectSpace then
		-- Default to an &quot;other namespaces&quot; namespace, so that we get at least some output
		-- if an error occurs.
		subjectSpace = 2
	end
	local data = {}
	
	-- Heading
	local heading = args.heading -- Blank values are not removed.
	if heading == &#039;&#039; then
		-- Don&#039;t display the start box if the heading arg is defined but blank.
		return nil
	end
	if heading then
		data.heading = heading
	elseif subjectSpace == 10 then -- Template namespace
		data.heading = message(&#039;documentation-icon-wikitext&#039;) .. &#039; &#039; .. message(&#039;template-namespace-heading&#039;)
	elseif subjectSpace == 828 then -- Module namespace
		data.heading = message(&#039;documentation-icon-wikitext&#039;) .. &#039; &#039; .. message(&#039;module-namespace-heading&#039;)
	elseif subjectSpace == 6 then -- File namespace
		data.heading = message(&#039;file-namespace-heading&#039;)
	else
		data.heading = message(&#039;other-namespaces-heading&#039;)
	end
	
	-- Heading CSS
	local headingStyle = args[&#039;heading-style&#039;]
	if headingStyle then
		data.headingStyleText = headingStyle
	else
		-- &#039;documentation-heading&#039;
		data.headingClass = message(&#039;main-div-heading-class&#039;)
	end
	
	-- Data for the [view][edit][history][purge] or [create] links.
	if links then
		-- &#039;mw-editsection-like plainlinks&#039;
		data.linksClass = message(&#039;start-box-link-classes&#039;)
		data.links = links
	end
	
	return data
end

function p.renderStartBox(data)
	-- Renders the start box html.
	-- @data - a table of data generated by p.makeStartBoxData.
	local sbox = mw.html.create(&#039;div&#039;)
	sbox
		-- &#039;documentation-startbox&#039;
		:addClass(message(&#039;start-box-class&#039;))
		:newline()
		:tag(&#039;span&#039;)
			:addClass(data.headingClass)
			:cssText(data.headingStyleText)
			:wikitext(data.heading)
	local links = data.links
	if links then
		sbox:tag(&#039;span&#039;)
			:addClass(data.linksClass)
			:attr(&#039;id&#039;, data.linksId)
			:wikitext(links)
	end
	return tostring(sbox)
end

----------------------------------------------------------------------------
-- Documentation content
----------------------------------------------------------------------------

p.content = makeInvokeFunc(&#039;_content&#039;)

function p._content(args, env)
	-- Displays the documentation contents
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	env = env or p.getEnvironment(args)
	local docTitle = env.docTitle
	local content = args.content
	if not content and docTitle and docTitle.exists then
		content = args._content or mw.getCurrentFrame():expandTemplate{title = docTitle.prefixedText}
	end
	-- The line breaks below are necessary so that &quot;=== Headings ===&quot; at the start and end
	-- of docs are interpreted correctly.
	return &#039;\n&#039; .. (content or &#039;&#039;) .. &#039;\n&#039; 
end

p.contentTitle = makeInvokeFunc(&#039;_contentTitle&#039;)

function p._contentTitle(args, env)
	env = env or p.getEnvironment(args)
	local docTitle = env.docTitle
	if not args.content and docTitle and docTitle.exists then
		return docTitle.prefixedText
	else
		return &#039;&#039;
	end
end

----------------------------------------------------------------------------
-- End box
----------------------------------------------------------------------------

p.endBox = makeInvokeFunc(&#039;_endBox&#039;)

function p._endBox(args, env)
	--[=[
	-- This function generates the end box (also known as the link box).
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- 
	--]=]
	
	-- Get environment data.
	env = env or p.getEnvironment(args)
	local subjectSpace = env.subjectSpace
	local docTitle = env.docTitle
	if not subjectSpace or not docTitle then
		return nil
	end
		
	-- Check whether we should output the end box at all. Add the end
	-- box by default if the documentation exists or if we are in the
	-- user, module or template namespaces.
	local linkBox = args[&#039;link box&#039;]
	if linkBox == &#039;off&#039;
		or not (
			docTitle.exists
			or subjectSpace == 2
			or subjectSpace == 828
			or subjectSpace == 10
		)
	then
		return nil
	end

	-- Assemble the link box.
	local text = &#039;&#039;
	if linkBox then
		text = text .. linkBox
	else
		text = text .. (p.makeDocPageBlurb(args, env) or &#039;&#039;) -- &quot;This documentation is transcluded from [[Foo]].&quot; 
		if subjectSpace == 2 or subjectSpace == 10 or subjectSpace == 828 then
			-- We are in the user, template or module namespaces.
			-- Add sandbox and testcases links.
			-- &quot;Editors can experiment in this template&#039;s sandbox and testcases pages.&quot;
			text = text .. (p.makeExperimentBlurb(args, env) or &#039;&#039;) .. &#039;&lt;br /&gt;&#039;
			if not args.content and not args[1] then
				-- &quot;Please add categories to the /doc subpage.&quot;
				-- Don&#039;t show this message with inline docs or with an explicitly specified doc page,
				-- as then it is unclear where to add the categories.
				text = text .. (p.makeCategoriesBlurb(args, env) or &#039;&#039;)
			end
			text = text .. &#039; &#039; .. (p.makeSubpagesBlurb(args, env) or &#039;&#039;) --&quot;Subpages of this template&quot;
			local printBlurb = p.makePrintBlurb(args, env) -- Two-line blurb about print versions of templates.
			if printBlurb then
				text = text .. &#039;&lt;br /&gt;&#039; .. printBlurb
			end
		end
	end
	
	local box = mw.html.create(&#039;div&#039;)
	-- &#039;documentation-metadata&#039;
	box:addClass(message(&#039;end-box-class&#039;))
		-- &#039;plainlinks&#039;
		:addClass(message(&#039;end-box-plainlinks&#039;))
		:wikitext(text)
		:done()

	return &#039;\n&#039; .. tostring(box)
end

function p.makeDocPageBlurb(args, env)
	--[=[
	-- Makes the blurb &quot;This documentation is transcluded from [[Template:Foo]] (edit, history)&quot;.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- 
	-- Messages:
	-- &#039;edit-link-display&#039; --&gt; &#039;edit&#039;
	-- &#039;history-link-display&#039; --&gt; &#039;history&#039;
	-- &#039;transcluded-from-blurb&#039; --&gt; 
	-- &#039;The above [[Wikipedia:Template documentation|documentation]] 
	-- is [[Help:Transclusion|transcluded]] from $1.&#039;
	-- &#039;module-preload&#039; --&gt; &#039;Template:Documentation/preload-module-doc&#039;
	-- &#039;create-link-display&#039; --&gt; &#039;create&#039;
	-- &#039;create-module-doc-blurb&#039; --&gt;
	-- &#039;You might want to $1 a documentation page for this [[Wikipedia:Lua|Scribunto module]].&#039;
	--]=]
	local docTitle = env.docTitle
	if not docTitle then
		return nil
	end
	local ret
	if docTitle.exists then
		-- /doc exists; link to it.
		local docLink = makeWikilink(docTitle.prefixedText)
		local editUrl = docTitle:fullUrl{action = &#039;edit&#039;}
		local editDisplay = message(&#039;edit-link-display&#039;)
		local editLink = makeUrlLink(editUrl, editDisplay)
		local historyUrl = docTitle:fullUrl{action = &#039;history&#039;}
		local historyDisplay = message(&#039;history-link-display&#039;)
		local historyLink = makeUrlLink(historyUrl, historyDisplay)
		ret = message(&#039;transcluded-from-blurb&#039;, {docLink})
			.. &#039; &#039;
			.. makeToolbar(editLink, historyLink)
			.. &#039;&lt;br /&gt;&#039;
	elseif env.subjectSpace == 828 then
		-- /doc does not exist; ask to create it.
		local createUrl = docTitle:fullUrl{action = &#039;edit&#039;, preload = message(&#039;module-preload&#039;)}
		local createDisplay = message(&#039;create-link-display&#039;)
		local createLink = makeUrlLink(createUrl, createDisplay)
		ret = message(&#039;create-module-doc-blurb&#039;, {createLink})
			.. &#039;&lt;br /&gt;&#039;
	end
	return ret
end

function p.makeExperimentBlurb(args, env)
	--[[
	-- Renders the text &quot;Editors can experiment in this template&#039;s sandbox (edit | diff) and testcases (edit) pages.&quot;
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- 
	-- Messages:
	-- &#039;sandbox-link-display&#039; --&gt; &#039;sandbox&#039;
	-- &#039;sandbox-edit-link-display&#039; --&gt; &#039;edit&#039;
	-- &#039;compare-link-display&#039; --&gt; &#039;diff&#039;
	-- &#039;module-sandbox-preload&#039; --&gt; &#039;Template:Documentation/preload-module-sandbox&#039;
	-- &#039;template-sandbox-preload&#039; --&gt; &#039;Template:Documentation/preload-sandbox&#039;
	-- &#039;sandbox-create-link-display&#039; --&gt; &#039;create&#039;
	-- &#039;mirror-edit-summary&#039; --&gt; &#039;Create sandbox version of $1&#039;
	-- &#039;mirror-link-display&#039; --&gt; &#039;mirror&#039;
	-- &#039;mirror-link-preload&#039; --&gt; &#039;Template:Documentation/mirror&#039;
	-- &#039;sandbox-link-display&#039; --&gt; &#039;sandbox&#039;
	-- &#039;testcases-link-display&#039; --&gt; &#039;testcases&#039;
	-- &#039;testcases-edit-link-display&#039;--&gt; &#039;edit&#039;
	-- &#039;template-sandbox-preload&#039; --&gt; &#039;Template:Documentation/preload-sandbox&#039;
	-- &#039;testcases-create-link-display&#039; --&gt; &#039;create&#039;
	-- &#039;testcases-link-display&#039; --&gt; &#039;testcases&#039;
	-- &#039;testcases-edit-link-display&#039; --&gt; &#039;edit&#039;
	-- &#039;module-testcases-preload&#039; --&gt; &#039;Template:Documentation/preload-module-testcases&#039;
	-- &#039;template-testcases-preload&#039; --&gt; &#039;Template:Documentation/preload-testcases&#039;
	-- &#039;experiment-blurb-module&#039; --&gt; &#039;Editors can experiment in this module&#039;s $1 and $2 pages.&#039;
	-- &#039;experiment-blurb-template&#039; --&gt; &#039;Editors can experiment in this template&#039;s $1 and $2 pages.&#039;
	--]]
	local subjectSpace = env.subjectSpace
	local templateTitle = env.templateTitle
	local sandboxTitle = env.sandboxTitle
	local testcasesTitle = env.testcasesTitle
	local templatePage = templateTitle.prefixedText
	if not subjectSpace or not templateTitle or not sandboxTitle or not testcasesTitle then
		return nil
	end
	-- Make links.
	local sandboxLinks, testcasesLinks
	if sandboxTitle.exists then
		local sandboxPage = sandboxTitle.prefixedText
		local sandboxDisplay = message(&#039;sandbox-link-display&#039;)
		local sandboxLink = makeWikilink(sandboxPage, sandboxDisplay)
		local sandboxEditUrl = sandboxTitle:fullUrl{action = &#039;edit&#039;}
		local sandboxEditDisplay = message(&#039;sandbox-edit-link-display&#039;)
		local sandboxEditLink = makeUrlLink(sandboxEditUrl, sandboxEditDisplay)
		local compareUrl = env.compareUrl
		local compareLink
		if compareUrl then
			local compareDisplay = message(&#039;compare-link-display&#039;)
			compareLink = makeUrlLink(compareUrl, compareDisplay)
		end
		sandboxLinks = sandboxLink .. &#039; &#039; .. makeToolbar(sandboxEditLink, compareLink)
	else
		local sandboxPreload
		if subjectSpace == 828 then
			sandboxPreload = message(&#039;module-sandbox-preload&#039;)
		else
			sandboxPreload = message(&#039;template-sandbox-preload&#039;)
		end
		local sandboxCreateUrl = sandboxTitle:fullUrl{action = &#039;edit&#039;, preload = sandboxPreload}
		local sandboxCreateDisplay = message(&#039;sandbox-create-link-display&#039;)
		local sandboxCreateLink = makeUrlLink(sandboxCreateUrl, sandboxCreateDisplay)
		local mirrorSummary = message(&#039;mirror-edit-summary&#039;, {makeWikilink(templatePage)})
		local mirrorPreload = message(&#039;mirror-link-preload&#039;)
		local mirrorUrl = sandboxTitle:fullUrl{action = &#039;edit&#039;, preload = mirrorPreload, summary = mirrorSummary}
		if subjectSpace == 828 then
			mirrorUrl = sandboxTitle:fullUrl{action = &#039;edit&#039;, preload = templateTitle.prefixedText, summary = mirrorSummary}
		end
		local mirrorDisplay = message(&#039;mirror-link-display&#039;)
		local mirrorLink = makeUrlLink(mirrorUrl, mirrorDisplay)
		sandboxLinks = message(&#039;sandbox-link-display&#039;) .. &#039; &#039; .. makeToolbar(sandboxCreateLink, mirrorLink)
	end
	if testcasesTitle.exists then
		local testcasesPage = testcasesTitle.prefixedText
		local testcasesDisplay = message(&#039;testcases-link-display&#039;)
		local testcasesLink = makeWikilink(testcasesPage, testcasesDisplay)
		local testcasesEditUrl = testcasesTitle:fullUrl{action = &#039;edit&#039;}
		local testcasesEditDisplay = message(&#039;testcases-edit-link-display&#039;)
		local testcasesEditLink = makeUrlLink(testcasesEditUrl, testcasesEditDisplay)
		-- for Modules, add testcases run link if exists
		if testcasesTitle.contentModel == &quot;Scribunto&quot;  and testcasesTitle.talkPageTitle and testcasesTitle.talkPageTitle.exists then
			local testcasesRunLinkDisplay = message(&#039;testcases-run-link-display&#039;)
			local testcasesRunLink = makeWikilink(testcasesTitle.talkPageTitle.prefixedText, testcasesRunLinkDisplay)
			testcasesLinks = testcasesLink .. &#039; &#039; .. makeToolbar(testcasesEditLink, testcasesRunLink)
		else
			testcasesLinks = testcasesLink .. &#039; &#039; .. makeToolbar(testcasesEditLink)
		end
	else
		local testcasesPreload
		if subjectSpace == 828 then
			testcasesPreload = message(&#039;module-testcases-preload&#039;)
		else
			testcasesPreload = message(&#039;template-testcases-preload&#039;)
		end
		local testcasesCreateUrl = testcasesTitle:fullUrl{action = &#039;edit&#039;, preload = testcasesPreload}
		local testcasesCreateDisplay = message(&#039;testcases-create-link-display&#039;)
		local testcasesCreateLink = makeUrlLink(testcasesCreateUrl, testcasesCreateDisplay)
		testcasesLinks = message(&#039;testcases-link-display&#039;) .. &#039; &#039; .. makeToolbar(testcasesCreateLink)
	end
	local messageName
	if subjectSpace == 828 then
		messageName = &#039;experiment-blurb-module&#039;
	else
		messageName = &#039;experiment-blurb-template&#039;
	end
	return message(messageName, {sandboxLinks, testcasesLinks})
end

function p.makeCategoriesBlurb(args, env)
	--[[
	-- Generates the text &quot;Please add categories to the /doc subpage.&quot;
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	-- Messages:
	-- &#039;doc-link-display&#039; --&gt; &#039;/doc&#039;
	-- &#039;add-categories-blurb&#039; --&gt; &#039;Please add categories to the $1 subpage.&#039;
	--]]
	local docTitle = env.docTitle
	if not docTitle then
		return nil
	end
	local docPathLink = makeWikilink(docTitle.prefixedText, message(&#039;doc-link-display&#039;))
	return message(&#039;add-categories-blurb&#039;, {docPathLink})
end

function p.makeSubpagesBlurb(args, env)
	--[[
	-- Generates the &quot;Subpages of this template&quot; link.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	
	-- Messages:
	-- &#039;template-pagetype&#039; --&gt; &#039;template&#039;
	-- &#039;module-pagetype&#039; --&gt; &#039;module&#039;
	-- &#039;default-pagetype&#039; --&gt; &#039;page&#039;
	-- &#039;subpages-link-display&#039; --&gt; &#039;Subpages of this $1&#039;
	--]]
	local subjectSpace = env.subjectSpace
	local templateTitle = env.templateTitle
	if not subjectSpace or not templateTitle then
		return nil
	end
	local pagetype
	if subjectSpace == 10 then
		pagetype = message(&#039;template-pagetype&#039;)
	elseif subjectSpace == 828 then
		pagetype = message(&#039;module-pagetype&#039;)
	else
		pagetype = message(&#039;default-pagetype&#039;)
	end
	local subpagesLink = makeWikilink(
		&#039;Special:PrefixIndex/&#039; .. templateTitle.prefixedText .. &#039;/&#039;,
		message(&#039;subpages-link-display&#039;, {pagetype})
	)
	return message(&#039;subpages-blurb&#039;, {subpagesLink})
end

function p.makePrintBlurb(args, env)
	--[=[
	-- Generates the blurb displayed when there is a print version of the template available.
	-- @args - a table of arguments passed by the user
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	--
	-- Messages:
	-- &#039;print-link-display&#039; --&gt; &#039;/Print&#039;
	-- &#039;print-blurb&#039; --&gt; &#039;A [[Help:Books/for experts#Improving the book layout|print version]]&#039;
	--		.. &#039; of this template exists at $1.&#039;
	--		.. &#039; If you make a change to this template, please update the print version as well.&#039;
	-- &#039;display-print-category&#039; --&gt; true
	-- &#039;print-category&#039; --&gt; &#039;Templates with print versions&#039;
	--]=]
	local printTitle = env.printTitle
	if not printTitle then
		return nil
	end
	local ret
	if printTitle.exists then
		local printLink = makeWikilink(printTitle.prefixedText, message(&#039;print-link-display&#039;))
		ret = message(&#039;print-blurb&#039;, {printLink})
		local displayPrintCategory = message(&#039;display-print-category&#039;, nil, &#039;boolean&#039;)
		if displayPrintCategory then
			ret = ret .. makeCategoryLink(message(&#039;print-category&#039;))
		end
	end
	return ret
end

----------------------------------------------------------------------------
-- Tracking categories
----------------------------------------------------------------------------

function p.addTrackingCategories(env)
	--[[
	-- Check if {{documentation}} is transcluded on a /doc or /testcases page.
	-- @env - environment table containing title objects, etc., generated with p.getEnvironment
	
	-- Messages:
	-- &#039;display-strange-usage-category&#039; --&gt; true
	-- &#039;doc-subpage&#039; --&gt; &#039;doc&#039;
	-- &#039;testcases-subpage&#039; --&gt; &#039;testcases&#039;
	-- &#039;strange-usage-category&#039; --&gt; &#039;Wikipedia pages with strange ((documentation)) usage&#039;
	-- 
	-- /testcases pages in the module namespace are not categorised, as they may have
	-- {{documentation}} transcluded automatically.
	--]]
	local title = env.title
	local subjectSpace = env.subjectSpace
	if not title or not subjectSpace then
		return nil
	end
	local subpage = title.subpageText
	local ret = &#039;&#039;
	if message(&#039;display-strange-usage-category&#039;, nil, &#039;boolean&#039;)
		and (
			subpage == message(&#039;doc-subpage&#039;)
			or subjectSpace ~= 828 and subpage == message(&#039;testcases-subpage&#039;)
		)
	then
		ret = ret .. makeCategoryLink(message(&#039;strange-usage-category&#039;))
	end
	return ret
end

return p
</pre>

<!-- 
NewPP limit report
Cached time: 20240126144325
Cache expiry: 86400
Reduced expiry: false
Complications: [notocconversion]
CPU time usage: 0.008 seconds
Real time usage: 0.009 seconds
Preprocessor visited node count: 2/1000000
Postexpand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 1/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip postexpand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div></div><div class="printfooter">
Retrieved from <a dir="ltr" href="https://wiki.signalcartel.space/index.php?title=Module:Documentation&amp;oldid=1929">https://wiki.signalcartel.space/index.php?title=Module:Documentation&amp;oldid=1929</a></div>
<div class="visualClear"></div></div></div></div></div><div id="content-bottom-stuff"><div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div></div></div><div id="mw-site-navigation"><div id="p-logo" class="mw-portlet" role="banner"><a class="mw-wiki-logo fallback" href="index.php.html" title="Visit the main page"></a></div><div id="site-navigation" class="sidebar-chunk"><h2><span>Navigation</span></h2><div class="sidebar-inner"><div role="navigation" class="mw-portlet" id="p-navigation" aria-labelledby="p-navigation-label"><h3 id="p-navigation-label" lang="en-GB" dir="ltr">Navigation</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="n-mainpage-description" class="mw-list-item"><a href="index.php.html" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-Quick-links" class="mw-list-item"><a href="Quick_Links_to_Popular_Pages.html"><span>Quick links</span></a></li><li id="n-Categories" class="mw-list-item"><a href="Special%253ACategories.html"><span>Categories</span></a></li><li id="n-Public-pages" class="mw-list-item"><a href="Category%253APublic.html"><span>Public pages</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="Special%253ARecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-randompage" class="mw-list-item"><a href="Special%253ARandom.html" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li><li id="n-help-mediawiki" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" target="_blank"><span>Help about MediaWiki</span></a></li></ul></div></div><div role="navigation" class="mw-portlet" id="p-Corp_Comms" aria-labelledby="p-Corp_Comms-label"><h3 id="p-Corp_Comms-label" lang="en-GB" dir="ltr">Corp Comms</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="n-Discord-Server" class="mw-list-item"><a href="https://discord.gg/0qn6aJxK8iwEfiwF" rel="nofollow" target="_blank"><span>Discord Server</span></a></li><li id="n-Signal-Cartel-Blog" class="mw-list-item"><a href="https://www.signalcartel.org/" rel="nofollow" target="_blank"><span>Signal Cartel Blog</span></a></li></ul></div></div><div role="navigation" class="mw-portlet" id="p-EVE_Time" aria-labelledby="p-EVE_Time-label"><h3 id="p-EVE_Time-label" lang="en-GB" dir="ltr">EVE Time</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="n-clock" class="mw-list-item"><a href="https://wiki.signalcartel.space/Clock"><span>clock</span></a></li></ul></div></div></div></div><div id="site-tools" class="sidebar-chunk"><h2><span>Wiki tools</span></h2><div class="sidebar-inner"><div role="navigation" class="mw-portlet" id="p-tb" aria-labelledby="p-tb-label"><h3 id="p-tb-label" lang="en-GB" dir="ltr">Wiki tools</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="t-upload" class="mw-list-item"><a href="Special%253AUpload.html" title="Upload files [u]" accesskey="u"><span>Upload file</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="Special%253ASpecialPages.html" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li></ul></div></div></div></div></div><div id="mw-related-navigation"><div id="page-tools" class="sidebar-chunk"><h2><span>Page tools</span></h2><div class="sidebar-inner"><div role="navigation" class="mw-portlet" id="p-cactions" title="More options" aria-labelledby="p-cactions-label"><h3 id="p-cactions-label" lang="en-GB" dir="ltr">Page tools</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="ca-move" class="mw-list-item"><a href="https://wiki.signalcartel.space/Special:MovePage/Module:Documentation" title="Move this page [m]" accesskey="m"><span>Move</span></a></li></ul></div></div><div role="navigation" class="mw-portlet emptyPortlet" id="p-userpagetools" aria-labelledby="p-userpagetools-label"><h3 id="p-userpagetools-label" lang="en-GB" dir="ltr">User page tools</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"></ul></div></div><div role="navigation" class="mw-portlet" id="p-pagemisc" aria-labelledby="p-pagemisc-label"><h3 id="p-pagemisc-label" lang="en-GB" dir="ltr">More</h3><div class="mw-portlet-body"><ul lang="en-GB" dir="ltr"><li id="t-whatlinkshere" class="mw-list-item"><a href="Special%253AWhatLinksHere/Module%253ADocumentation.html" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="https://wiki.signalcartel.space/Special:RecentChangesLinked/Module:Documentation" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Module:Documentation&amp;oldid=1929" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Module:Documentation&amp;action=info" title="More information about this page"><span>Page information</span></a></li><li id="t-pagelog" class="mw-list-item"><a href="https://wiki.signalcartel.space/index.php?title=Special:Log&amp;page=Module%3ADocumentation"><span>Page logs</span></a></li></ul></div></div></div></div></div><div class="visualClear"></div></div></div><div id="mw-footer-container" class="mw-footer-container ts-container"><div id="mw-footer" class="mw-footer ts-inner" role="contentinfo" lang="en-GB" dir="ltr"><ul id="footer-icons"><li id="footer-copyrightico" class="footer-icons"><a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank"><img src="resources/assets/licenses/cc-by-sa.png" width="88" height="31" loading="lazy"/></a></li><li id="footer-poweredbyico" class="footer-icons"><a href="https://www.mediawiki.org/" target="_blank"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li></ul><div id="footer-list"><ul id="footer-info"><li id="footer-info-lastmod"> This page was last modified on 11 December 2020, at 13:55.</li><li id="footer-info-copyright">The Explorer's Compendium is available under the Creative Commons Attribution-ShareAlike License unless otherwise noted. All EVE related materials are property of CCP Games. For more information, please click <a href="Public%253ACopyright.html" title="Public:Copyright"><b>here</b></a>.</li></ul><ul id="footer-places"><li id="footer-places-privacy"><a href="The_Explorer's_Compendium%253APrivacy_policy.html">Privacy policy</a></li><li id="footer-places-about"><a href="The_Explorer's_Compendium%253AAbout.html">About The Explorer&#039;s Compendium</a></li><li id="footer-places-disclaimers"><a href="The_Explorer's_Compendium%253AGeneral_disclaimer.html">Disclaimers</a></li></ul></div><div class="visualClear"></div></div></div></div><script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":513,"wgPageParseReport":{"limitreport":{"cputime":"0.008","walltime":"0.009","ppvisitednodes":{"value":2,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":1,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20240126144325","ttl":86400,"transientcontent":false}}});});</script>
</body>
</html>